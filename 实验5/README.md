# 实验五  用户界面设计

## 一、实验目的

1. 了解以控件为中心的RAD程序开发方式
2. 熟悉菜单、对话框、工具栏、状态栏等控件的使用
3. 熟悉ListView、TreeView等控件的使用

## 二、实验时间和地点

学时：2学时

## 三、实验任务和步骤

1、设计一个类似 “写字板”的界面，（注意右键菜单的使用）并实现：

1. “文件”的新建，打开，保存，打印，退出等操作
1. 格式中的“字体”
1. “查看”操作
1. “编辑”的大部分功能
1. “帮助”的“关于”

1. 设计一个类似IE浏览器的界面，并实现：
1. 有菜单栏，工具栏，状态栏
1. 实现“主页”，“转到”，“刷新”,“后退”，“前进”等功能
1. 点击“Internet选项”，弹出相应界面，实现“设置主页”功能

在当前界面使用TabControl控件进行布局
![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215847640-a47786f6-a2ae-4362-8339-eaaa2f78dc54.png#)  
图1 Internet选项界面

1. ListView控件基本操作。

要求设置ListView控件外观、添加项、删除项和获取选中项改变事件。

![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215848150-6b7063e9-1229-4464-9845-29933e5e821d.png#)  
图2  程序运行效果图  
实验过程和要求：

1. 添加ListView等控件（以下只说明ListView的设置）；其中”年龄”后面的控件采用“NumericUpDown”控件。

（2）设置ListView外观  
1）打开ListView控件的属性面板，首先设置View属性的属性值为Details。  
2）然后设置各列标题，找到Columns属性，单击其右侧的“…”图标，如图2所示。弹出ColumnHeader（列标题）集合编辑器对话框，如图3所示。在该对话框中可以编辑各列标题、各列宽度以各列的显示顺序等。单击对话框左侧的【添加】按钮，即可添加一个列，默认名称为columnHeader1，然后在对话框右侧可以设置该列的Text显示文本、Width宽度等属性，还可以通过DisplayIndex属性设置各列的显示顺序。  
![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215848358-3cb93943-22e8-4825-96dc-e869a22ce9e3.png#)  
图3 设置Columns属性
![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215848713-b9676a95-ea18-4639-ad37-b60d5a99e05d.png#)
图4 ColumnHeader集合编辑器  
3）设置各列标题后的ListView控件如图4所示，从图中可以看到ListView控件已经显示各列的标题，但是没有显示单元格分隔线条（网络线）。设置GridLine属性的属性值为True，可以显示ListView网格线，如图5所示。
![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215848932-83aeb4b7-9548-495c-a432-0414078bc28b.png#)  
 图5 设置列标题后的ListView控件
![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215849199-e2de3ad9-794e-4c13-913e-cee7668d1aab.png#)  
图6 设置GridLine属性后的ListView控件  
4）设置ListView控件的其他属性，分别设置FullRowSelect属性的属性值为True，设置MultiSelect属性的属性值为False，外观与普通表格相同。  
（3）编写代码。
如果要为列表项添加一行，应使用如下代码：（如果是从其他途径获得数据，只需要修改实参就好）
![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215849400-44f0f2a9-0c3e-4fc6-bb00-c8883ecdb962.png#)
删除行使用以下代码：

![](https://cdn.nlark.com/yuque/0/2022/png/23075474/1642215849815-c6d056bc-32cd-4fa1-993c-c24936f5542d.png#)

1. TreeView控件基本操作

实现一个类似“资源管理器”的界面，并要求实现：

1. 快捷菜单，并可以“新建”一个项，或子项
1. 在TreeView中选择目录，可以在ListView中显示所包含的内容
1. 在ListView中有快捷菜单，可以新建目录或项，其中目录与TreeView同步；在快捷菜单中可以选择大图标、小图标、列表和详细信息等方式显示

内容可以任选，如商品、书目章节等均可。

## 1 实验要求

独立完成，交由老师检查并登记，完成实验报告（要求记录实验过程和运行结果，并说明遇到的问题和解决方法）

## 2 实验总结  

不少于200字。
思考：选中ListView控件中的一行，然后将选中内容显示在上面的各个控件中， 应当如何 实现?
